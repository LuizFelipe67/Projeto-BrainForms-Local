<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Menu - BrainForms</title>
    
    <style>
        
        /* ================================================
           ESTILOS BASE PARA DESKTOP 
           ================================================ */

/* Estiliza o corpo da p√°gina */
body {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, #6B2D7F 0%, #8c4fa8 50%, #9B6BB8 100%);
    margin: 0;
    padding: 0;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Navbar superior para desktop */
.navbar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 90px;
    background: linear-gradient(to bottom, #000000 0%, #3A024E 80%);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    justify-content: space-between;
  padding: 0 clamp(16px, 5vw, 80px);
  box-sizing: border-box; /* impede que o padding aumente a largura al√©m de 100% */
    z-index: 1000;
}

.navbar-logo {
    display: flex;
    align-items: center;
    gap: 15px;
}

.navbar-logo img {
    width: 85px;
    height: 70px;
}

.navbar-logo span {
    font-size: 28px;
    font-weight: bold;
    color: white;
}

/* Container do perfil com dropdown */
.navbar-profile {
    position: relative;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    padding: 8px 12px;
    border-radius: 50px;
    transition: all 0.3s ease;
  /* Evita que o container ultrapasse a tela em nomes longos */
  flex: 0 1 auto;
  min-width: 0;
  max-width: 40vw;
}

.navbar-profile:hover {
    background: rgba(255, 255, 255, 0.1);
}

.profile-info {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  min-width: 0; /* permite truncar texto longo */
}

.profile-name {
    color: white;
    font-size: 16px;
    font-weight: 600;
    margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis; /* evita empurrar o perfil para fora */
}

/* Avatar na navbar */
.navbar-avatar {
    --ring: 3px;
    display: inline-grid;
    place-items: center;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(180deg, #00f7ff 0%, #6a00ff 35%, #f82dff 100%);
    box-shadow: 0 0 8px rgba(106,0,255,0.3);
}

.navbar-avatar img {
    width: calc(100% - (var(--ring) * 2));
    height: calc(100% - (var(--ring) * 2));
    border-radius: 50%;
    object-fit: cover;
    z-index: 1;
}

/* Seta dropdown */
.dropdown-arrow {
    color: white;
    font-size: 16px;
    transition: transform 0.3s ease;
}

.navbar-profile.active .dropdown-arrow {
    transform: rotate(180deg);
}

/* Menu dropdown */
.dropdown-menu {
  position: absolute; /* centraliza em rela√ß√£o ao perfil */
  top: 65px; /* abaixo do perfil (desktop) */
  left: 50%;
  right: auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  min-width: 220px;
  max-width: 250px;
  padding: 8px;
  opacity: 0;
  visibility: hidden;
  transform: translate(-50%, -10px);
  transition: all 0.3s ease;
  z-index: 2000;
}

.dropdown-menu.show {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, 0);
}

.dropdown-menu a {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    color: #5E097E;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.2s ease;
}

.dropdown-menu a:hover {
    background: #F2F3FD;
    transform: translateX(4px);
}

.dropdown-menu a img {
    width: 24px;
    height: 24px;
   
}

#perfil {
    border-radius: 50%;
}



.dropdown-divider {
    height: 1px;
    background: #e0e0e0;
    margin: 8px 0;
}

/* Container principal - layout profissional */
.section {
    margin-top: 110px;
    padding: 50px 60px;
    max-width: 1400px;
    margin-left: auto;
    margin-right: auto;
}

/* Hero section */
.hero-section {
    text-align: left;
    color: white;
    margin-bottom: 60px;
}

.hero-section h1 {
    font-size: 48px;
    margin: 0 0 20px 0;
    font-weight: 700;
    color: #a107ee;
    text-shadow: 2px 2px 12px rgba(45, 10, 62, 0.7), 0 0 25px rgba(144, 54, 228, 0.5);
}

.hero-section p {
    font-size: 22px;
    opacity: 0.95;
    margin: 0;
    color: #e0d4ff;
}

/* Grid de bot√µes para desktop */
.buttons-desk {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 30px;
    margin-bottom: 40px;
}

.buttons-desk a {
    background-color: #F2F3FD;
    border: 3px solid #440459;
    border-radius: 20px;
    padding: 40px;
    box-shadow: 10px 0 20px rgba(34, 2, 45, 0.4);
    transition: all 0.3s ease;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 30px;
    text-decoration: none;
    color: inherit;
}

.buttons-desk a:hover {
    transform: translateY(-5px);
    box-shadow: 12px 0 25px rgba(68, 4, 89, 0.6);
    background-color: #D8D2F0;
}

.buttons-desk img {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
}

.buttons-desk .button-content {
    flex: 1;
}

.buttons-desk .button-content h3 {
    font-size: 26px;
    color: #5E097E;
    margin: 0 0 10px 0;
    font-weight: 700;
}

.buttons-desk .button-content p {
    font-size: 16px;
    color: #440459;
    margin: 0;
    line-height: 1.6;
}

/* Bot√µes especiais (largura completa) */
.buttons-desk .button-full {
    grid-column: 1 / -1;
    background-color: #F2F3FD;
    border: 3px solid #440459;
}

.buttons-desk .button-full:hover {
    background-color: #D8D2F0;
    border-color: #440459;
}

.buttons-desk .button-full .button-content h3,
.buttons-desk .button-full .button-content p {
    color: #5E097E;
}

.buttons-desk .button-full .button-content p {
    color: #440459;
}

/* ELEMENTOS MOBILE-ONLY (ESCONDIDOS NO DESKTOP) */
.background-logo-container,
.menu-container,
.header-container,
.footer {
    display: none;
}

/* Elementos do tutorial (mantidos globais) */
.blurred {
  filter: blur(5px);
}

.start-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: linear-gradient(135deg, rgba(94, 9, 126, 0.95) 0%, rgba(119, 80, 133, 0.95) 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.start-box {
  background: white;
  width: 90%;
  max-width: 500px;
  min-height: 450px;
  padding: 40px 30px;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
  text-align: center;
  animation: slideIn 0.5s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.tutorial-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 20px;
  width: 100%;
}

.tutorial-content img {
  width: 120px;
  height: 120px;
  object-fit: contain;
  margin-bottom: 10px;
}

.start-box h1 {
  font-size: 32px;
  color: #5E097E;
  margin: 0;
  font-weight: 700;
}

.start-box h3 {
  font-size: 18px;
  color: #333;
  line-height: 1.6;
  margin: 0;
  font-weight: 400;
}

.tutorial-navigation {
  display: flex;
  gap: 15px;
  width: 100%;
  margin-top: 20px;
}

.tutorial-navigation button {
  flex: 1;
  padding: 14px 20px;
  font-size: 16px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-skip {
  background: linear-gradient(135deg, #072752 0%, #124583 100%);
  color: white;
}

.btn-skip:hover {
  background: linear-gradient(135deg, #2c5282 0%, #3b6cb8 100%);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(30, 58, 95, 0.4);
}

.btn-next {
  background: linear-gradient(135deg, #5E097E 0%, #9036e4 100%);
  color: white;
}

.btn-next:hover {
  background: linear-gradient(135deg, #9036e4 0%, #b368f5 100%);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(94, 9, 126, 0.4);
}

.progress-dots {
  display: flex;
  gap: 8px;
  margin: 20px 0;
}

.progress-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: #d0d0d0;
  transition: all 0.3s ease;
}

.progress-dot.active {
  background: linear-gradient(135deg, #5E097E 0%, #9036e4 100%);
  width: 30px;
  border-radius: 5px;
}

 /* ================================================
    MEDIA QUERY: TABLETS (481px - 1023px)
    ================================================ */
    @media (min-width: 481px) and (max-width: 1023px) {
      .navbar {
        padding: 0 clamp(16px, 4vw, 60px);
        height: 80px;
      }

      .navbar-logo img {
        width: 55px;
        height: 55px;
      }

      .navbar-logo span {
        font-size: 24px;
      }

      .navbar-profile {
        gap: 8px;
      }

      .navbar-avatar {
        width: 45px;
        height: 45px;
      }

      .profile-name {
        font-size: 14px;
      }

      .dropdown-menu {
        position: absolute;
        min-width: 200px;
        max-width: 230px;
        left: 50%;
        right: auto;
        top: 60px; /* abaixo do perfil (tablet) */
        transform: translate(-50%, -10px);
      }

      .section {
        padding: 40px 30px;
        margin-top: 100px;
      }

      .hero-section h1 {
        font-size: 36px;
      }

      .hero-section p {
        font-size: 18px;
      }

      .buttons-desk {
        gap: 20px;
      }

      .buttons-desk a {
        padding: 30px;
      }

      .buttons-desk img {
        width: 60px;
        height: 60px;
      }

      .buttons-desk .button-content h3 {
        font-size: 22px;
      }

      .buttons-desk .button-content p {
        font-size: 14px;
      }
    }


 /* ================================================
    MEDIA QUERY: TELAS GRANDES (1440px+)
    ================================================ */
    @media (min-width: 1440px) {
      .start-box {
        max-width: 600px;
        min-height: 500px;
        padding: 50px 40px;
      }

      .start-box h1 {
        font-size: 36px;
      }

      .start-box h3 {
        font-size: 20px;
      }

      .tutorial-content img {
        width: 140px;
        height: 140px;
      }

      /* Hero section maior */
      .hero-section h1 {
        font-size: 56px;
      }

      .hero-section p {
        font-size: 26px;
      }

      /* Bot√µes maiores */
      .buttons-desk a {
        padding: 50px;
      }

      .buttons-desk img {
        width: 100px;
        height: 100px;
      }

      .buttons-desk .button-content h3 {
        font-size: 30px;
      }

      .buttons-desk .button-content p {
        font-size: 18px;
      }

      /* Navbar maior */
      .navbar {
        height: 100px;
        padding: 0 clamp(24px, 5vw, 100px);
      }

      .navbar-logo img {
        width: 75px;
        height: 75px;
      }

      .navbar-logo span {
        font-size: 32px;
      }

      .navbar-profile {
        gap: 15px;
      }

      .navbar-avatar {
        width: 55px;
        height: 55px;
      }

      .profile-name {
        font-size: 18px;
      }

      .dropdown-arrow {
        font-size: 22px;
      }

      .dropdown-menu {
        position: absolute;
        min-width: 220px;
        max-width: 240px;
        top: 70px; /* abaixo do perfil (telas grandes) */
        left: 50%;
        right: auto;
        transform: translate(-50%, -10px);
      }

      .section {
        margin-top: 130px;
        padding: 60px 80px;
      }
}


 /* ================================================
    MEDIA QUERY: MOBILE (max-width: 480px)
    MANT√âM O DESIGN ORIGINAL
    ================================================ */
     @media (max-width: 480px) {
        /* Esconde elementos desktop */
        .navbar,
        .section,
        .hero-section,
        .buttons-desk {
            display: none !important;
        }

        /* Mostra elementos mobile */
        .background-logo-container,
        .menu-container,
        .header-container,
        .footer {
            display: flex !important;
        }

        /* Corpo da p√°gina mobile */
        body {
          margin: 0;
          bottom: 0;
          padding-bottom: 0;
          flex-direction: column;
          display: flex;
          justify-content: center;
          align-items: center;
          min-height: 100vh;
          background-color: #775085;
          overflow-y: auto;
        }

        .background-logo-container {
          display: none !important;
        }

        /* Tutorial mobile */
        .start-box {
          width: 90%;
          min-height: 400px;
          padding: 30px 20px;
        }

        .start-box h1 {
          font-size: 24px;
        }

        .start-box h3 {
          font-size: 16px;
        }

        .tutorial-content img {
          width: 90px;
          height: 90px;
        }

        .tutorial-navigation button {
          padding: 12px 15px;
          font-size: 14px;
        }

        /* Container principal mobile */
        .menu-container {
          top: -1px;
          position: relative;
          margin: 0 auto;
          width: 95%;
          height: 98vh;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          box-sizing: border-box;
          background-color: #fff;
          border-radius: 12px;
          box-shadow: 0 0 20px rgba(34, 2, 45, 0.6);
          text-align: center;
          overflow: hidden;
        }

        /* Cabe√ßalho mobile */
        .header-container {
          display: flex;
          align-items: center;
          background: linear-gradient(to bottom, #000000 0%, #3A024E 80%);
          padding: 15px 20px;
          border-radius: 12px 12px 0 0;
          color: white;
          width: 100%;
          margin-bottom: 30px;
        }

        .header-container img {
          width: 65px;
          margin-right: 10px;
        }

        .header-container h3 {
          margin: 0;
          font-size: 20px;
        }

        /* T√≠tulo mobile */
        .menu-container h2 {
          text-align: left;
          padding-left: 20px;
          margin-top: 20px;
          color: #5E097E;
          margin-bottom: -30px;
        }

        /* Container de bot√µes mobile */
        .button-container {
          flex-grow: 1;
          overflow-y: auto;
          display: flex;
          flex-direction: column;
          gap: 10px;
          align-items: center;
          margin-top: 60px;
          padding: 0 20px;
          overflow: visible;
        }

        /* Linha de bot√µes mobile */
        .button-container .row {
          display: flex;
          gap: 20px;
          justify-content: center;
          width: 100%;
        }

        /* Bot√µes mobile */
        .menu-container button {
          background-color: #F2F3FD;
          color: #5E097E;
          border: 2px solid #440459;
          border-radius: 16px;
          padding: 10px;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
          width: 100%;
          height: auto;
          max-height: 160px;
          min-height: 80px;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          box-shadow: 10px 0 14px rgba(34, 2, 45, 0.5);
          flex-shrink: 1;
          overflow: hidden;
          white-space: normal;
          text-overflow: ellipsis;
          margin-top: 50px;
        }

        .menu-container button:hover {
          box-shadow: 12px 0 18px rgba(48, 10, 62, 0.7);
          background-color: #D8D2F0;
          transform: scale(1.02);
        }

        .menu-container button img {
          width: 65px;
          height: 65px;
          margin-bottom: 15px;
          flex-shrink: 0;
        }

        .button-container span {
          font-size: 18px;
          word-break: break-word;
        }

        /* Bot√µes especiais mobile */
        .menu-container .questionarios-button,
        .menu-container .minigames-button {
          margin-top: 15px;
          flex-direction: row;
          align-items: center;
          height: 100px;
        }

        .menu-container .questionarios-button img {
          margin-right: 15px;
          margin-bottom: 0;
          width: 65px;
          height: 65px;
        }

        .menu-container .minigames-button img {
          margin-bottom: -5px;
          margin-left: 15px;
          width: 65px;
          height: 65px;
        }

        /* Rodap√© mobile */
        .footer {
          background-color: #300A3E;
          display: flex;
          justify-content: center;
          align-items: center;
          position: absolute;
          bottom: 0;
          width: 100%;
          height: 80px;
          gap: 80px;
          padding: 0;
        }

        .footer img {
          width: 65px;
          height: 60px;
          padding: 0;
          display: block;
          margin: 0;
        }

        /* Avatar mobile */
        .footer a[href="avatar.html"] {
          --ring: 3px;
          display: inline-grid;
          place-items: center;
          width: 58px;
          height: 58px;
          border-radius: 50%;
          position: relative;
          background: linear-gradient(180deg, #00f7ff 0%, #6a00ff 35%, #f82dff 100%);
          box-shadow: 0 0 8px rgba(106,0,255,0.10);
        }

        #menuAvatar {
          width: calc(100% - (var(--ring) * 2));
          height: calc(100% - (var(--ring) * 2));
          border-radius: 50%;
          object-fit: cover;
          z-index: 1;
        }
        
    }

   


    </style>
</head>
<body>

    <!-- ========================================
         NAVBAR SUPERIOR (DESKTOP)
         ======================================== -->
    <nav class="navbar">
        <div class="navbar-logo">
            <img src="Imagens/Logo sem Fundo.png" alt="Logo BrainForms">
            <span>BrainForms</span>
        </div>
        
        <div class="navbar-profile" onclick="toggleDropdown(event)">
            <div class="navbar-avatar">
                <img id="navbarAvatar" src="Imagens/perfil.png" alt="Perfil">
            </div>
            <div class="profile-info">
                <p class="profile-name" id="navbar-user-name">Usu√°rio</p>
            </div>
            <span class="dropdown-arrow">‚ñº</span>
            
            <!-- Menu Dropdown -->
            <div class="dropdown-menu" id="dropdown-menu">
                <a href="avatar.html">
                    <img id="perfil" src="Imagens/perfil.png" alt="Perfil">
                    <span>Meu Perfil</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="conquistas.html">
                    <img src="Imagens/conquistaBar.png" alt="Conquistas">
                    <span>Conquistas</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="menu.html">
                    <img src="Imagens/menuBar.png" alt="Menu">
                    <span>Menu Principal</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- ========================================
         CONTE√öDO PRINCIPAL (DESKTOP)
         ======================================== -->
    <div class="section">
        <div class="hero-section">
            <h1>Navegue pelo Sistema</h1>
            <p>Explore o mundo da Matem√°tica e F√≠sica de forma interativa</p>
        </div>

        <div class="buttons-desk">
            <a href="calcular-matematica.html">
                <img src="Imagens/mat.png" alt="Matem√°tica">
                <div class="button-content">
                    <h3>F√≥rmulas Matem√°ticas</h3>
                    <p>Explore equa√ß√µes, geometria, logaritmos, trigonometria e muito mais!</p>
                </div>
            </a>

            <a href="calcular-fisica.html">
                <img src="Imagens/fisic.png" alt="F√≠sica">
                <div class="button-content">
                    <h3>F√≥rmulas F√≠sicas</h3>
                    <p>Calcule cinem√°tica, eletrost√°tica, convers√µes e outras f√≥rmulas f√≠sicas.</p>
                </div>
            </a>

            <a href="menu-questoes.html" class="button-full">
                <img src="Imagens/quest.png" alt="Question√°rios">
                <div class="button-content">
                    <h3>Question√°rios Interativos</h3>
                    <p>Teste seus conhecimentos com exerc√≠cios pr√°ticos de Matem√°tica e F√≠sica!</p>
                </div>
            </a>

            <a href="mini-games.html" class="button-full">
                <img src="Imagens/game.png" alt="Mini Games">
                <div class="button-content">
                    <h3>Mini Games</h3>
                    <p>Desafie-se com jogos educativos e divirta-se enquanto aprende!</p>
                </div>
            </a>
        </div>
    </div>

      <!-- ========================================
           ESTRUTURA MOBILE (ANTIGA)
           ======================================== -->

      <!-- LOGO E TEXTO NO BACKGROUND (MOBILE) -->
      <div class="background-logo-container">
        <img src="Imagens/Logo sem Fundo.png" alt="Logo BrainForms Fundo">
        <span>BrainForms</span>
      </div>

    <!-- Container principal do menu (MOBILE) -->
    <div class="menu-container">
        <!-- Cabe√ßalho com logo e t√≠tulo -->
        <div class="header-container">
            <img src="Imagens/Logo sem Fundo.png" alt="Logo BrainForms"> <!-- Logo -->
            <h3>BrainForms</h3> <!-- Nome do sistema -->
        </div>

        <!-- T√≠tulo da se√ß√£o abaixo do cabe√ßalho -->
        <h2>Navegue pelo sistema</h2>

        <!-- Container que agrupa os bot√µes -->
        <div class="button-container">
            <!-- Linha com dois bot√µes lado a lado -->
            <div class="row">
                <!-- Bot√£o para f√≥rmulas matem√°ticas -->
                <button onclick="location.href='calcular-matematica.html'">
                    <img src="Imagens/mat.png" alt="Matem√°tica"> <!-- √çcone da matem√°tica -->
                    <span>F√≥rmulas Matem√°ticas</span> <!-- Texto do bot√£o -->
                </button>

                <!-- Bot√£o para f√≥rmulas f√≠sicas -->
                <button onclick="location.href='calcular-fisica.html'">
                    <img src="Imagens/fisic.png" alt="F√≠sica"> <!-- √çcone da f√≠sica -->
                    <span>F√≥rmulas F√≠sicas</span> <!-- Texto do bot√£o -->
                </button>
            </div>

            <!-- Bot√£o para question√°rios, ocupa linha completa -->
            <button onclick="location.href='menu-questoes.html'" class="questionarios-button">
                <img src="Imagens/quest.png" alt="Question√°rio"> <!-- √çcone do question√°rio -->
                <span>Question√°rios</span> <!-- Texto do bot√£o -->
            </button>

            <!-- Bot√£o para mini games -->
            <button onclick="location.href='mini-games.html'" class="minigames-button">
                <span>Mini Games</span> <!-- Texto do bot√£o -->
                <img src="Imagens/game.png" alt="Mini Games"> <!-- √çcone dos mini games -->
            </button>
        </div>

        <!-- Rodap√© com tr√™s √≠cones (aumentados e centralizados corretamente) -->
        <div class="footer">
            <a href="avatar.html">
            <img id="menuAvatar" src="Imagens/perfil.png" alt="Perfil"> <!-- √çcone do perfil -->
            </a>

            <a href="conquistas.html">
             <img src="Imagens/conquistas.png" alt="Conquistas" style= "padding-left: 7px;"> <!-- √çcone das conquistas -->
            </a>
            
            <a href="menu.html">
            <img  src="Imagens/menu.png" alt="Menu"> <!-- √çcone do menu -->
            </a>
        </div>

    </div>


    <!-- Overlay de boas-vindas -->
    <div class="start-overlay" id="start-overlay" style="display: none;">
        <div class="start-box">
            <div class="tutorial-content" id="tutorial-content">
                <!-- Conte√∫do din√¢mico ser√° inserido aqui -->
            </div>
            
            <div class="progress-dots" id="progress-dots">
                <!-- Dots ser√£o inseridos dinamicamente -->
            </div>
            
            <div class="tutorial-navigation">
                <button class="btn-skip" onclick="skipTutorial()">Pular</button>
                <button class="btn-next" onclick="nextSlide()">Pr√≥ximo</button>
            </div>
        </div>
    </div>

<script src="js/conquistas-utils.js"></script>

<script>
  // Fun√ß√£o para toggle do dropdown
  function toggleDropdown(event) {
      event?.stopPropagation();
      const dropdown = document.getElementById('dropdown-menu');
      const profile = document.querySelector('.navbar-profile');
      
    const willShow = !dropdown.classList.contains('show');
    dropdown.classList.toggle('show');
    profile.classList.toggle('active');

    // Ajuste inteligente para evitar que o dropdown saia da tela
    if (willShow) {
      // reset para o estado centralizado padr√£o via CSS
      dropdown.style.left = '';
      dropdown.style.right = '';
      dropdown.style.transform = '';

      const rect = dropdown.getBoundingClientRect();
      const padding = 8; // margem de seguran√ßa

      if (rect.right > (window.innerWidth - padding)) {
        // encosta na direita do perfil sem ultrapassar a tela
        dropdown.style.left = 'auto';
        dropdown.style.right = '0';
        dropdown.style.transform = 'translateY(0)';
      } else if (rect.left < padding) {
        // encosta na esquerda do perfil sem ultrapassar a tela
        dropdown.style.left = '0';
        dropdown.style.right = 'auto';
        dropdown.style.transform = 'translateY(0)';
      }
    } else {
      // limpamos estilos inline ao fechar, para voltar ao centrado padr√£o
      dropdown.style.left = '';
      dropdown.style.right = '';
      dropdown.style.transform = '';
    }
  }

  // Fecha o dropdown ao clicar fora
  document.addEventListener('click', function(event) {
      const profile = document.querySelector('.navbar-profile');
      const dropdown = document.getElementById('dropdown-menu');
      
      if (profile && !profile.contains(event.target)) {
          dropdown?.classList.remove('show');
          profile?.classList.remove('active');
      }
  });

  document.addEventListener("DOMContentLoaded", async () => {
      const token = sessionStorage.getItem("token");
      if (!token) return;
      
      // Carrega avatar (primeiro do sessionStorage, depois do backend)
      const menuAvatar = document.getElementById("menuAvatar");
      const navbarAvatar = document.getElementById("navbarAvatar");
      let savedAvatar = sessionStorage.getItem("alunoAvatar");
      
      // Atualiza ambos os avatares (mobile e desktop)
      if (savedAvatar) {
          if (menuAvatar) menuAvatar.src = savedAvatar;
          if (navbarAvatar) navbarAvatar.src = savedAvatar;
      } else {
          // Se n√£o tiver no sessionStorage, busca do backend
          try {
              const avatarResponse = await fetch("http://localhost:8000/api/avatar/show", {
                  headers: { 
                      "Authorization": `Bearer ${token}`,
                      "Accept": "application/json",
                  },
              });
              if (avatarResponse.ok) {
                  const avatarData = await avatarResponse.json();
                  if (avatarData.avatar_url) {
                      if (menuAvatar) menuAvatar.src = avatarData.avatar_url;
                      if (navbarAvatar) navbarAvatar.src = avatarData.avatar_url;
                      sessionStorage.setItem("alunoAvatar", avatarData.avatar_url);
                  }
              }
          } catch (error) {
              console.warn("Erro ao carregar avatar:", error);
          }
      }

      // ‚úÖ Busca dados do aluno sempre no primeiro carregamento da p√°gina
      try {
          const res = await fetch(`${API_URL}/api/alunos/me`, {
              headers: { "Authorization": `Bearer ${token}` }
          });

          if (!res.ok) throw new Error("Falha ao buscar aluno");

          const aluno = await res.json();
          
          console.log("Aluno carregado:", aluno);
          console.log("Primeiro login?", aluno.primeiro_login);

          // ‚úÖ Salva o nome do aluno na session (em todos os logins)
          sessionStorage.setItem("alunoNome", aluno.name);
          
          // Define o nome do usu√°rio no elemento da navbar e outras √°reas
          const navbarUserName = document.getElementById("navbar-user-name");
          if (navbarUserName) {
              navbarUserName.textContent = aluno.name;
          }
          
          const nomeUsuarioEl = document.getElementById("nome-usuario");
          if (nomeUsuarioEl) {
              nomeUsuarioEl.textContent = aluno.name;
          }

          // ================================
          // SISTEMA DE TUTORIAL DE BOAS-VINDAS
          // ================================
          const tutorialSlides = [
              {
                  icon: 'Imagens/Logo sem Fundo.png',
                  title: 'Bem-vindo(a) ao BrainForms!',
                  text: `Ol√°, <span style="font-weight:bold; color: #650591;">${aluno.name}</span>! 
                  Estamos muito felizes em ter voc√™ aqui. Prepare-se para explorar o mundo da Matem√°tica e F√≠sica de forma divertida e interativa!`
              },
              {
                  icon: 'Imagens/forms.png',
                  title: 'F√≥rmulas Interativas',
                  text: `Explore diversas f√≥rmulas de Matem√°tica e F√≠sica! Calcule equa√ß√µes, geometria, convers√µes de temperatura 
                  e muito mais. Cada c√°lculo conta para suas conquistas!`
              },
              {
                  icon: 'Imagens/quest.png',
                  title: 'Question√°rios',
                  text:  `Teste seus conhecimentos com question√°rios de Matem√°tica e F√≠sica! Resolva exerc√≠cios pr√°ticos, 
                  aprenda com feedback imediato e acompanhe seu progresso. `
              },
              {
                  icon: 'Imagens/game.png',
                  title: 'Mini Games',
                  text:  `Divirta-se enquanto aprende! Nossa se√ß√£o de Mini Games oferece diferentes desafios para testar 
                  suas habilidades cognitivas e conhecimento. Com o Time Quizz, voc√™ responde perguntas contra o rel√≥gio, 
                  onde rapidez e precis√£o aumentam sua pontua√ß√£o!`
              },
              {
                  icon: 'Imagens/conquistasTitulo.png',
                  title: 'Conquistas',
                  text:  `Complete desafios e desbloqueie conquistas incr√≠veis! Cada a√ß√£o no BrainForms pode render 
                  uma nova conquista. Colete todas elas!\n
                  Voc√™ pode acompanhar suas conquistas na se√ß√£o dedicada, acessando a aba do seu perfil no cabe√ßalho. `
              },
              {
                  icon: 'Imagens/perfilDefault.png',
                  title: 'Seu Perfil',
                  text:  `Personalize seu perfil com avatares √∫nicos! Escolha entre v√°rios avatares ou fa√ßa upload da sua pr√≥pria foto.
                   Mostre sua personalidade! `
              }
          ];

          let currentSlide = 0;

          function renderSlide(index) {
              const slide = tutorialSlides[index];
              const content = document.getElementById('tutorial-content');
              
              content.innerHTML = `
                  <img src="${slide.icon}" alt="${slide.title}">
                  <h1>${slide.title}</h1>
                  <h3>${slide.text}</h3>
              `;

              // Atualizar dots de progresso
              const dotsContainer = document.getElementById('progress-dots');
              dotsContainer.innerHTML = tutorialSlides.map((_, i) => 
                  `<div class="progress-dot ${i === index ? 'active' : ''}"></div>`
              ).join('');

              // Atualizar texto do bot√£o
              const nextBtn = document.querySelector('.btn-next');
              if (nextBtn) {
                  nextBtn.textContent = index === tutorialSlides.length - 1 ? 'Come√ßar' : 'Pr√≥ximo';
              }
          }

          window.nextSlide = () => {
              if (currentSlide < tutorialSlides.length - 1) {
                  currentSlide++;
                  renderSlide(currentSlide);
              } else {
                  finishTutorial();
              }
          };

          window.skipTutorial = () => {
              finishTutorial();
          };

          async function finishTutorial() {
              console.log("üé¨ Finalizando tutorial...");
              document.getElementById("start-overlay").style.display = "none";

              try {
                  console.log("üì° Marcando boas-vindas no backend...");
                  const response = await fetch(`${API_URL}/api/alunos/${aluno.id}/marcar-boas-vindas`, {
                      method: "POST",
                      headers: {
                          "Authorization": `Bearer ${token}`,
                          "Content-Type": "application/json"
                      }
                  });
                  console.log("‚úÖ Boas-vindas marcadas com sucesso:", await response.json());
              } catch (err) {
                  console.error("‚ùå Erro ao marcar boas-vindas:", err);
              }

              // Marcar que o aluno j√° viu o tutorial
              sessionStorage.setItem("alunoCarregado", "true");

              // Mostrar conquistas automaticamente
              try {
                  console.log("üèÜ Carregando conquistas...");
                  const conquistas = await window.carregarConquistasAPI?.();
                  console.log("üìã Conquistas carregadas:", conquistas);
                  
                  if (conquistas?.length) {
                      console.log("üéâ Mostrando conquistas ao usu√°rio...");
                      window.mostrarNovasConquistasLocal?.(conquistas, true);
                  } else {
                      console.log("‚ÑπÔ∏è Nenhuma conquista para mostrar");
                  }
              } catch (err) {
                  console.error("‚ùå Erro ao carregar conquistas:", err);
              }
          }

          // FUN√á√ÉO GLOBAL DE IN√çCIO (mantida para compatibilidade)
          window.startGame = finishTutorial;

          // ====================================================
          // VERIFICAR E MOSTRAR TUTORIAL SE FOR PRIMEIRO LOGIN
          // ====================================================
          if (aluno.primeiro_login) {
              console.log("üéì √â o primeiro login! Mostrando tutorial...");
              
              const overlayEl = document.getElementById("start-overlay");
              if (!overlayEl) {
                  console.error("‚ùå Elemento start-overlay n√£o encontrado!");
                  return;
              }
              
              overlayEl.style.display = "flex";
              console.log("‚úÖ Overlay exibido");
              
              // Renderizar primeiro slide
              renderSlide(0);
              console.log("‚úÖ Primeiro slide renderizado");
          } else {
              console.log("‚úÖ N√£o √© primeiro login. Tutorial j√° foi visto.");
              // Marca que o aluno foi carregado nesta sess√£o
              sessionStorage.setItem("alunoCarregado", "true");
          }

      } catch (err) {
          console.error("Erro ao carregar aluno:", err);
      }
  });

  // ================================
  // Fun√ß√£o para trocar avatar
  // ================================
  function trocarAvatar(src) {
      document.getElementById('mainAvatar').src = src;
      try {
          sessionStorage.setItem('alunoAvatar', src);
      } catch (e) {
          console.warn('N√£o foi poss√≠vel salvar o avatar na sessionStorage:', e);
      }
  }

  // Upload de imagem personalizada
  document.getElementById("uploadInput").addEventListener("change", function(event) {
      const file = event.target.files[0];
      if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
              const dataUrl = e.target.result;
              document.getElementById("mainAvatar").src = dataUrl;
              try {
                  sessionStorage.setItem('alunoAvatar', dataUrl);
              } catch (err) {
                  console.warn('N√£o foi poss√≠vel salvar avatar na sessionStorage:', err);
              }
          }
          reader.readAsDataURL(file);
      }
  });
</script>



</body>
</html>
